曹丕见吴蜀联合，不由得大怒。于是留司马懿守许昌，亲率三十万大军，起兵伐吴。孙权一面修书请诸葛亮出兵汉中，分魏军兵势，一面命徐盛率军拒敌。在广陵附近一场大战，徐盛用计火攻，曹丕损兵折将；又得知赵云兵出阳平关，曹丕只得回兵。张辽在战场上中箭，回到许都，不治身亡。曹丕厚葬之。

	 

	诸葛亮在成都，事无大小，都亲自公断。两川之地，夜不闭户，路不拾遗；又逢连年丰收，一时府库充盈，军需充足。

	 

	建兴三年，蛮王孟获连合建宁太守雍闿等人谋反。诸葛亮寻思南蛮不服，终为后患，便亲率大军，前去征讨。

	 

	诸葛亮先用反间计击杀雍闿等人，平定反叛州郡，便率大军向南蛮推进。永昌人吕凯献了一幅“平蛮指掌图”，图上标明可屯兵交战之处。诸葛亮大喜，便用吕凯为行军教授，兼向导官。

	 

	正行进间，天子差马谡为使慰劳军士。诸葛亮接诏后留马谡叙谈。马谡道：“南蛮自恃山险地远，今日平定，明日又叛。丞相一到，必能平服；丞相班师，蛮兵又反。因此用兵之道，攻心为上。丞相定要收服其心。”诸葛亮深以为然，便留马谡为参军。

	 

	孟获得知诸葛亮破了雍闿等人，忙召三洞元帅商议。孟获命金环三结元帅取中路，董荼奴元帅取左路，阿会喃元帅取右路，各引蛮兵五万，分三路拒敌。

	 

	诸葛亮得报，便升帐点将。诸葛亮道：“蛮兵三路来迎，本想让子龙，文长去敌，可惜二人不识地理，不敢任用。”当下分派已定，只不用赵云、魏延。二人心中不悦，诸葛亮道：“我不想你二人涉险，失了锐气，并非不用。”二人回到寨中，计议道：“我二人为先锋，丞相不用，却用后辈小子，岂不羞人！”二人便商定各提本部兵马去捉蛮兵。

	 

	二人捉了几个蛮兵，问明情形，便于当夜突袭蛮兵大营。赵云杀入，正遇着金环三结元帅，一枪刺落马下。二人便分兵两路，分别向左右路蛮兵大寨杀去。蛮兵不敌，两洞元帅走脱。

	 

	赵云等回营，献上金环三结首级，说逃了两洞元帅。诸葛亮大笑道：“我早已派人擒下了。”不久，张嶷解董荼奴到，张翼解阿会喃到。原来诸葛亮故意用言语激赵云、魏延立功，早已安排兵马接应。两洞元帅逃过山去，束手就擒。诸葛亮命人放了两洞元帅，赏了衣食，令他们归洞，不得助恶。二人痛哭流涕，回洞去了。

	 

	诸葛亮料想孟获必会亲自引兵前来，便命赵云、魏延各引一军，王平、关索同引一军，依计而行。自己在帐中，坐等捷报。

	 

	孟获见三洞元帅兵败，便亲率蛮兵来攻。王平敌住。战不数回合，王平败走，孟获猛追；遇着关索，战了一阵，关索又退。正追杀间，忽然喊声大起，左有张嶷，右有张翼，两路兵杀出，截断归路。王平、关索杀回，蛮兵大败。孟获正奔走间，赵云拦住，冲杀一阵，孟获只带几十人越岭而逃。忽然一声炮响，魏延引步军杀出，生擒了孟获。

	 

	诸葛亮设宴，赐蛮兵酒食，放他们回去，吩咐不要再反。蛮兵感恩而回。不一会儿，魏延押孟获到帐中。诸葛亮道：“先帝对你不薄，为何反叛？”孟获道：“我世代居住此地，怎叫反叛！”诸葛亮道：“如今擒了你，你可心服？”孟获道：“山路狭小，误落你手，如何肯服！除非放我回去，整兵再战。再擒得我，方才心服。”诸葛亮便命松绑，赐了酒食，送与鞍马，放他回去。

	 

	诸葛亮放了孟获，众将上帐询问缘故。诸葛亮道：“我擒此人，如探囊取物。需要到降服其心，南方才会真正平定。”

	 

	孟获行到泸水，收拾手下残兵，汇集各洞酋长，准备再战。诸葛亮派马岱领兵渡泸水去断孟获粮道。因为不知地理，蜀兵白日渡泸水纷纷中毒，口鼻流血而死。马岱大惊，回报诸葛亮，诸葛亮即找当地土人询问，得知泸水白日有毒，只有夜静水冷方可渡过。诸葛亮于是派马岱引军夜间渡河，截断了孟获粮道。孟获派副将忙牙长领蛮兵来战马岱，交马一合就被马岱斩了。董荼奴领兵来战，马岱骂他忘恩负义，董荼奴羞愧而退。回见孟获，孟获大怒，要斩董荼奴，被众酋长劝住。当晚，孟获大醉卧于帐中。董荼奴感念诸葛丞相恩德，率众酋长绑了孟获来献给诸葛亮。孟获道此次是手下自相残害，非诸葛亮之能，依然不服。诸葛亮于是赐给酒食，再放孟获回去。

	 

	孟获回寨，与弟弟孟优商议，让孟优假意奉献礼物，然后孟获夜晚劫营，准备里应外和。此计被马谡识破，诸葛亮将计就计，孟获前来劫营又中埋伏，三番被擒，孟获依然不服，诸葛亮于是放孟获回去再战。

	 

	孟获回去，又聚集了数十万蛮兵，前来挑战。诸葛亮于是设计诈败，让孟获得了营寨，却派赵云、魏延等抄后路埋伏，孟获中计，被杀得大败，自己落入陷坑，又被诸葛亮擒了。孟获道：“我今误中诡计，死不瞑目！”诸葛亮于是再放孟获。

	 

	孟获回去，退至秃龙洞，投奔朵思大王，此处地势险恶，还有四处毒泉。蜀兵到时，果然纷纷中毒。诸葛亮于是登山寻找隐士求教了解救之法。结果孟获等又被洞主杨锋等擒获来献诸葛亮。

	 

	此后再战再擒，再擒再放，一连七次。孟获最终被诸葛亮真心所感，率妻子兄弟等人跪于诸葛亮帐前，发誓子子孙孙感谢丞相之德，永不复反。诸葛亮便命孟获仍为洞主，孟获及众部下，无不感戴。此后诸葛亮班师回成都。

	 

	蜀汉建兴四年，魏主曹丕病死。曹丕之子曹叡此年十五岁，被立为大魏皇帝；曹真为大将军，陈群为司空，司马懿为骠骑大将军，共辅幼主。司马懿上表请收雍、凉二州，训练兵马。诸葛亮闻之，以为除司马懿深有谋略，其余皆不足道。马谡于是献计，令曹叡对司马懿大加猜忌，又派人四处张贴榜文传言司马懿欲另立新主。曹叡于是亲自领御林军十万，前来巡视。司马懿不知缘故，正想让天子观其兵威，于是起十余万大军来迎。得知天子怀疑他谋反，司马懿大惊失色，在曹叡车前哭拜，并请求领兵破蜀伐吴以表明忠心。曹叡还是听了华歆之言，将司马懿削职回乡，由曹真统领雍、凉兵马。司马懿悻悻而归。

	 

	消息传到川中，诸葛亮大喜。诸葛亮以为南方已平，已无后顾之忧；甲兵已足，正可恢复中原，便上表后主，出师北伐。